<html>
  <head>
    <meta name="strokestoretest" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Stroke Storage Demo</title>
  </head>
	
	<p>Stroke storage demo</p>

	<p id="demo0"></p>
	<p id="demo1"></p>
	<p id="demo2"></p>
	<p id="demo3"></p>
	<p id="demo4"></p>
	<p id="demo5"></p>

    <script>
		var strokepoint = {
			x: 10,
			y: 10,
			hierarchy: 0,
			xs: 5,
			ys: 5
		};
		var strokestorage = [strokepoint]; // just stores a reference to the object in the array
		
		document.getElementById("demo0").innerHTML =
			strokepoint.x + " x " + strokepoint.y + " y";
		
		document.getElementById("demo1").innerHTML =
			strokestorage[0].xs;
		
		strokepoint.xs = 6;
		strokestorage.push(strokepoint);
		
		document.getElementById("demo2").innerHTML =
			"xs0 " + strokestorage[0].xs + " xs1 " + strokestorage[1].xs;
		
		// this structure is generated by hierarchy h (from 0 to whatever is desired, 4 for now)
		// generator is (2^(h+1))^2*8
		// the array for the data has then 8 * 2^2 * (1-(2^2)^(h+1))/(1-2^2) elements
		// (the sum from storage length for the lowest hierarchy to the highest hierarchy)
		// Set the length of an array: array.length=number
		var spstruct = [2, 4, 16]; // could use map() to create this: e.g. numbers.map(Math.sqrt)
		// better to have two access arrays: one with the lengths of the hierarchy storage, the other with the sums of the index lengths
		var x = [];
		var h = [];
		var outstr ="x ";
		var outstr1 ="h ";
		var currhie = 0;
		var sumi = spstruct[0];
		
		for(i=0; i<22; i++) {
			x.push(i);
			if(i==sumi) {
				currhie++;
				sumi += spstruct[currhie];
			}
			h.push(currhie);
			outstr += x[i] + " ";
			outstr1 += h[i] + " ";
		}
		
		document.getElementById("demo3").innerHTML = outstr;
		document.getElementById("demo4").innerHTML = outstr1;
		
		// summation helper function
		function shelp(b, c) {
			return (1 - Math.pow(b, c)) / (1 - b);
		}
		
		// summation helper function 2
		function shelp2(j) {
			var retsum = 0;
			for(i=0;i<j;i++)
				retsum += spstruct[i];
			return retsum;
		}
		
		// create an access function that fetches all values for a given hierarchy
		function gethierdata(myh) {
			var loweri = (myh==0) ? 0 : shelp2(myh);
			//var upperi = shelp(spstruct[myh], myh+1);
			var upperi = shelp2(myh+1);
			outstr1 = "struct: " + spstruct[myh] + " upper i " + upperi + ": f ";
			for(i=loweri; i<upperi; i++) {
				outstr1 += x[i] + " ";
			}
			document.getElementById("demo5").innerHTML = outstr1;
			return 0;
		}
		
		gethierdata(2);
		
    </script>
  </body>
</html>